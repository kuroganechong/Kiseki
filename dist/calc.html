<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Kiseki KR-Asia</title>
    <meta name="description" content="">
    <meta name="author" content="sagiri">

    <!-- Mobile Specific Metas
–––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans" rel="stylesheet">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <link rel="icon" type="image/png" href="images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
    <script src="https://unpkg.com/vue"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="css/custom.css">
</head>

<body>
    <div class="topnav" id="myTopnav">
        <a href="https://github.com/kuroganechong/Kiseki"><img src="images/github.png" alt="github" style="width: 1.5em; height: auto"></a>
        <a href="guild.html">Kiseki</a>
        <a href="index.html">ATK/CDMG</a>
        <a href="calc.html">Calculator</a>
        <a href="javascript:void(0);" class="icon" onclick="myFunction()">
            <i class="fa fa-bars"></i>
        </a>
    </div>
    <!-- Primary Page Layout
–––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <div class="container hide" id="app">
        <div class="row">
            <div class="twelve column">
                <h4>King's Raid - DMG Calculator</h4>
                <ol>
                    <li>Fill in your ATK/CDMG in your stat menu</li>
                    <li>Select any buffs applied</li>
                    <li>Fill in any additional dmg/stat buffs (guild buffs, other buffs ignored in the skill selection)</li>
                    <li>Fill in the observed damage per auto attack and calibrate/ Fill in the required skill values</li>
                    <li>Optional: fill in DEF and PEN values to see the effects of PEN</li>
                    <li>Check the result</li>
                </ol>
            </div>
        </div>
        <div class="sticky">
            <div class="row" id="hero-container">
                <div class="three columns">Hero<br>
                    <span>Hero description: <a v-bind:href="'https://maskofgoblin.com/hero/' + hero" target="_blank">LINK</a></span></div>
                <div class="nine columns">
                    <select class="u-full-width" id="hero" v-model="hero" v-on:change="reset">
                        <option v-for="(value, key) in heronames" v-bind:value="value">{{ key }}</option>
                    </select>
                </div>
            </div>
        </div>
        <hr>
        <div class="row" id="class-container">
            <div class="three columns">Class</div>
            <div class="nine columns">
                <span v-if="cl == 1">Knight</span>
                <span v-if="cl == 2">Warrior</span>
                <span v-if="cl == 3">Archer</span>
                <span v-if="cl == 4">Assassin</span>
                <span v-if="cl == 5">Mechanic</span>
                <span v-if="cl == 6">Wizard</span>
                <span v-if="cl == 7">Priest</span>
            </div>
        </div>
        <hr>
        <div class="row" id="stats-container">
            <div class="four columns">
                Stats
            </div>
            <div class="four columns">
                <label for="astatatktk">ATK</label>
                <input id="statatk" type="number" v-model="statatk">
            </div>
            <div class="four columns">
                <label for="statcdmg">CDMG</label>
                <input id="statcdmg" type="number" v-model="statcdmg">
            </div>
        </div>
        <hr>
        <div class="row" id="skill-container">
            <div class="three columns">
                Skills/Perks/UW UT Effects <br><br>

                Total skill ATK:
                <code>
                    <transition name="slide-fade" mode="out-in">
                        <span :key="'skillatk_' + skillatk + perkatk">{{ Number(skillatk) + Number(perkatk) }}%</span>
                    </transition>
                </code>,
                <br>
                Total skill CDMG:
                <code>
                    <transition name="slide-fade" mode="out-in">
                        <span :key="'skillcdmg_' + skillcdmg + perkcdmg">{{ Number(skillcdmg) + Number(perkcdmg) }}%</span>
                    </transition>
                </code>,
                <br>
                Total skill Flat ATK:
                <code>
                    <transition name="slide-fade" mode="out-in">
                        <span :key="'skillfa' + skillfa">{{ (skillfa + wa3fa).toLocaleString('en', {useGrouping:true}) }}</span>
                    </transition>
                </code>
            </div>
            <div class="nine columns">
                <!-- common -->
                <input type="checkbox" id="t1" value="" v-model="perk1"><label class="clickLabel" for="t1"><img src="images/t1atk.jpg"
                        alt="Atk up"></label><br><br>
                <!-- warrior -->
                <div v-if="cl == 2">
                    <input type="checkbox" id="wa1" value="wa1" v-model="perk2"><label class="clickLabel" for="wa1"><img
                            src="images/as2.jpg" alt="Opportune Strike"></label>
                    <input type="checkbox" id="wa2" value="wa2" v-model="perk2"><label class="clickLabel" for="wa2"><img
                            src="images/wa2.jpg" alt="Warlike"></label>
                    <input type="checkbox" id="wa3" value="wa3" v-model="perk2"><label class="clickLabel" for="wa3"><img
                            src="images/wa3.jpg" alt="Offensive Guard"></label><br>
                    <span v-if="perk2.includes('wa2')">Number of enemies: <input type="number" v-model="wa2"><br></span>
                    <span v-if="perk2.includes('wa3')">Stat menu PDEF: <input type="number" v-model="wa3base"><br></span>
                    <span v-if="perk2.includes('wa3')">PDEF% buff: <input type="number" v-model="wa3perc"><br></span>
                    <span v-if="perk2.includes('wa3')">Flat PDEF buff: <input type="number" v-model="wa3flat"><br></span>
                </div>
                <!-- assassin -->
                <div v-if="cl == 4">
                    <input type="checkbox" id="as1" value="as1" v-model="perk2"><label class="clickLabel" for="as1"><img
                            src="images/as1.jpg" alt="Target Weakness"></label>
                    <input type="checkbox" id="as2" value="as2" v-model="perk2"><label class="clickLabel" for="as2"><img
                            src="images/as2.jpg" alt="Opportune Strike"></label><br><br>
                </div>
                <!-- archer -->
                <div v-if="cl == 3">
                    <input type="checkbox" id="ar1" value="ar1" v-model="perk2"><label class="clickLabel" for="ar1"><img
                            src="images/ar1.jpg" alt="Precision Shot"></label>
                    <input type="checkbox" id="ar2" value="ar2" v-model="perk2"><label class="clickLabel" for="ar2"><img
                            src="images/as2.jpg" alt="Opportune Strike"></label><br><br>
                </div>
                <!-- mechanic -->
                <div v-if="cl == 5">
                    <input type="checkbox" id="me1" value="me1" v-model="perk2"><label class="clickLabel" for="me1"><img
                            src="images/as1.jpg" alt="Target Weakness"></label><br><br>
                </div>
                <!-- wizard -->
                <div v-if="cl == 6">
                    <input type="checkbox" id="wi1" value="wi1" v-model="perk2"><label class="clickLabel" for="wi1"><img
                            src="images/wi1.jpg" alt="Moral Rise"></label>
                    <input type="checkbox" id="wi2" value="wi2" v-model="perk2"><label class="clickLabel" for="wi2"><img
                            src="images/wi2.jpg" alt="Circuit Burst"></label><br><br>
                </div>
                <button class="collapsible">Hero skills/perks</button>
                <div class="content" id="parentcontent">
                    <hero v-for="post in posts" v-bind:key="String(post.ally) + String(post.id)" v-bind:post="post"
                        v-bind:hero="hero" @clicked="onClickChild" @selected="onSelect" @clickedt5="onClickT5"
                        @selectedut="onSelectUT"></hero>
                </div>
                <span class="small">Note: This selection only includes non-skill-exclusive ATK%, CDMG% and Flat ATK
                    buffs by
                    skills and perks. For damage boost buffs and stats buffs that only affect that skill, please add
                    them in the Additional stats row.</span>
            </div>
        </div>
        <hr>
        <div class="row" id="artifact-container">
            <div class="three columns">
                Artifact
            </div>
            <div class="three columns">
                <label for="art_1">Atk</label>
                <input id="art_1" type="number" v-model="art_1">%
            </div>
            <div class="three columns">
                <label for="art_2">CDmg</label>
                <input id="art_2" type="number" v-model="art_2">%
            </div>
            <div class="three columns">
                <label for="art_3">Creature Mask</label>
                <input id="art_3" type="number" v-model="art_3">%
            </div>
        </div>
        <hr>
        <div class="row">
            <div class="twelve columns small">
                Fill in any additional buffs such as guild buffs, skill-only stat buff, and damage boost effects.
                <a href="guide.html" target="_blank">GUIDE</a>
            </div>
        </div>
        <div class="row" id="scale-container">
            <div class="three columns">
                <label for="scale">DMG Boost</label>
                <input id="scale" type="number" v-model="scale">%
            </div>
            <div class="three columns">
                <label for="addatk">Additional ATK</label>
                <input id="addatk" type="number" v-model="addatk">%
            </div>
            <div class="three columns">
                <label for="addcdmg">Additional CDMG</label>
                <input id="addcdmg" type="number" v-model="addcdmg">%
            </div>
            <div class="three columns">
                <label for="Fa">Additional Flat ATK</label>
                <input id="Fa" type="number" v-model="Fa">
            </div>
        </div>
        <hr>
        <div class="row" id="heroscale-container">
            <div class="three columns">Calibrate the auto attack scaling for the first run:</div>
            <div class="three columns">
                <label for="obs">Observed auto attack damage in dummy</label>
                <input id="obs" type="number" v-model="obs">
            </div>
            <div class="three columns">
                <label for="heroscale">Auto attack scaling</label>
                <span id="heroscale">{{ heroscale * 100 }}%</span>
            </div>
            <div class="three columns"><button v-on:click="calibrate">Calibrate</button></div>
        </div>
        <hr>
        <div class="row" id="skillscale-container">
            <div class="three columns">Skill damage:<br><a href="https://docs.google.com/spreadsheets/d/1QfFyxwEgvIfwIpDXTPu-vD5vI75GQ6Is5NYcMFqUCyk/edit#gid=483914493"
                    target="_blank">LINK</a></div>
            <div class="three columns">
                <label for="skillbase">Skill Base value</label>
                <input id="skillbase" type="number" v-model="skillbase">
            </div>
            <div class="three columns">
                <label for="skillmulti">Skill ATK Multiplier value</label>
                <input id="skillmulti" type="number" v-model="skillmulti">
            </div>
            <div class="three columns">
                <label for="skillbook">Skill Book value</label>
                <input id="skillbook" type="number" v-model="skillbook">%
            </div>
        </div>
        <hr>
        <div class="row" id="pen-container">
            <div class="three columns">
                <label for="enemydef">Enemy DEF</label>
                <input id="enemydef" type="number" v-model="enemydef">
            </div>
            <div class="three columns">
                <label for="defshred">DEF Shred</label>
                <input id="defshred" type="number" v-model="defshred">
            </div>
            <div class="three columns">
                <label for="defdownperc">DEF% Debuff</label>
                <input id="defdownperc" type="number" v-model="defdownperc">%
            </div>
            <div class="three columns">
                <label for="pen">Total PEN value</label>
                <input id="pen" type="number" v-model="pen">
                <br><span>Effective PEN: {{effpen}}</span>%
            </div>
        </div>
        <hr>
        <div class="row" id="result-container">
            <h5>Result</h5>
            <table class="">
                <tbody>
                    <tr>
                        <td><strong>Before DEF reduction</strong></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>Auto Attack Final damage value:</td>
                        <td><code>
                                <transition name="slide-fade" mode="out-in">
                                    <span :key="'result_' + f">{{f.toLocaleString('en', {useGrouping:true})}}</span>
                                </transition>
                            </code></td>
                    </tr>
                    <tr>
                        <td><strong v-if="atkfocus == 1">Currently ATK% buffs worth more than CDMG% buffs!</strong>
                            <strong v-if="atkfocus == 0">Currently CDMG% buffs worth more than ATK% buffs!</strong></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>Skill Final damage value:</td>
                        <td><code>
                                <transition name="slide-fade" mode="out-in">
                                    <span :key="'skillresult_' + f">{{skillf.toLocaleString('en', {useGrouping:true})}}</span>
                                </transition>
                            </code></td>
                    </tr>
                    <tr>
                        <td><strong v-if="skillatkfocus == 1">For skill, currently ATK% buffs worth more than CDMG%
                                buffs!</strong>
                            <strong v-if="skillatkfocus == 0">For skill, currently CDMG% buffs worth more than ATK%
                                buffs!</strong></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><strong> DEF reduction</strong></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>Reduction due to DEF after PEN:</td>
                        <td><code>
                                <transition name="slide-fade" mode="out-in">
                                    <span :key="'defreduce_pen_' + defreduce ">{{ -((1-defreduce)*100).toFixed(2) }}%</span>
                                </transition></code></td>
                    </tr>
                    <tr>
                        <td>Decrease in Reduction per PEN:</td>
                        <td><code>
                                <transition name="slide-fade" mode="out-in">
                                    <span :key="'pen_' + percfpen">{{ (percfpen).toFixed(2) }}%</span>
                                </transition></code></td>
                    </tr>
                    <tr>
                        <td>Auto Attack Final damage value:</td>
                        <td><code>
                                <transition name="slide-fade" mode="out-in">
                                    <span :key="'result_' + f + 'DEF'">{{Math.round(f*defreduce).toLocaleString('en', {useGrouping:true})}}</span>
                                </transition>
                            </code></td>
                    </tr>
                    <tr>
                        <td>Skill Final damage value:</td>
                        <td><code>
                                <transition name="slide-fade" mode="out-in">
                                    <span :key="'skillresult_' + f + 'DEF'">{{Math.round(skillf*defreduce).toLocaleString('en', {useGrouping:true})}}</span>
                                </transition>
                            </code></td>
                    </tr>
                    <tr>
                        <td><strong>Suggestions</strong></td>
                        <td>These buffs give more benefit currently (if more than one is shown, they have the same
                                priority):
                            <ul>
                                <li v-if="penfocus.includes(0)">ATK%</li>
                                <li v-if="penfocus.includes(1)">CDMG%</li>
                                <li v-if="penfocus.includes(2)">PEN%</li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <hr>
    </div>

    <!-- End Document
–––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <script src="js/calc.js"></script>
</body>

</html>